<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 25 March 2009), see www.w3.org" />

  <title>nope</title>
  <script src="three.min.js"></script>
  <script type="text/javascript">
  function submitChat()
  {
    var input = document.getElementById('chatInput');
    var packetdata = {"type":"chat","msg":input.value};
    bridgeWV.broadcastMessage(JSON.stringify(packetdata));
    document.getElementById("chatout").innerHTML+="you say:<br/>"+input.value+"<br/>";
    input.value = "";
  }
  //bridge is defined in c++
  bridge.msgPush.connect(incomingMsg);
  function incomingMsg(packet){
      var packetdata = JSON.parse(packet.message);
      if (packetdata["type"] == "chat"){
        var text = packetdata["msg"];
        document.getElementById("chatout").innerHTML+=packet.peerName+" says:<br/>"+text+"<br/>";
      }
   }
   function chatKeyDown(e) {
       if (e.keyCode == 13) {
            submitChat()
           return false;
       }
   }
  </script>
</head>

<body>
  <p><a href="index.html">Back to index</a></p>
  <p id="demo"></p>
  Chat:
  <p id="chatout"></p>
    <input name="chatInput" id="chatInput" type="text" onkeypress="return chatKeyDown(event)" /> <button onclick=
    "submitChat()">Submit Message</button>

</body>
</html>
